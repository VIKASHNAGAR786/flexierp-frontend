<!-- 🔍 Search Bar + Actions -->
<div class="flex justify-between items-center mb-4 gap-2 flex-wrap">
  <!-- Search Input -->
  <input type="text" [(ngModel)]="filter.searchTerm" (ngModelChange)="getCustomerData()" 
    placeholder="Search customers..."
    class="px-4 py-2 rounded-lg bg-slate-800 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-[#00ffee] w-1/3" />

  <!-- 📑 Rows per page -->
  <select [(ngModel)]="filter.pageSize" (change)="getCustomerData()"
    class="px-3 py-2 rounded bg-slate-800 text-white border border-slate-600">
    <option *ngFor="let size of pageSizes" [value]="size">{{ size }} per page</option>
  </select>

  <!-- 📤 Export Buttons -->
  <div class="flex gap-2" *ngIf="customers.length > 0">
    <button (click)="exportToPdf()"
      class="flex items-center gap-1 px-3 py-2 bg-red-600 hover:bg-red-700 rounded text-white">
      <i class="fas fa-file-pdf"></i> PDF
    </button>
    <button (click)="exportToExcel()"
      class="flex items-center gap-1 px-3 py-2 bg-green-600 hover:bg-green-700 rounded text-white">
      <i class="fas fa-file-excel"></i> Excel
    </button>
  </div>
</div>


<!-- 📋 Customer Table -->
<div #customerTable class="overflow-x-auto overflow-y-auto bg-slate-900 rounded-lg shadow-lg relative max-h-[500px]">
  <table class="min-w-full text-white border-collapse">
    <thead
      class="bg-gradient-to-r from-slate-900 to-slate-800 text-[#00ffee] uppercase text-sm md:text-base tracking-wide sticky top-0 z-50">
      <tr>
        <th class="px-4 py-2 border-b border-slate-700">Sr.No</th>
        <th class="px-4 py-2 border-b border-slate-700">Customer Name</th>
        <th class="px-4 py-2 border-b border-slate-700">Contact No.</th>
        <th class="px-4 py-2 border-b border-slate-700">Email</th>
        <th class="px-4 py-2 border-b border-slate-700">City</th>
        <th class="px-4 py-2 border-b border-slate-700">Total Paid Amount</th>
        <th class="px-4 py-2 border-b border-slate-700">Total Balance Due</th>
        <th class="px-4 py-2 border-b border-slate-700">Last Transaction</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-slate-700">
      <tr *ngFor="let customer of customers; let i = index" class="hover:bg-slate-700 transition cursor-pointer"
          (click)="viewCustomerStatement(customer.customerId)">
        <td class="px-4 py-2 text-center">{{ (filter.pageNo - 1) * filter.pageSize + i + 1 }}</td>
        <td class="px-4 py-2 font-semibold">{{ customer.customerName }}</td>
        <td class="px-4 py-2 text-center">{{ customer.phone }}</td>
        <td class="px-4 py-2">{{ customer.email }}</td>
        <td class="px-4 py-2">{{ customer.city }}</td>
        <td class="px-4 py-2 text-center">{{ customer.openingBalance | currency:'INR':'symbol':'1.2-2' }}</td>
        <td class="px-4 py-2 text-center">{{ customer.totalDebit | currency:'INR':'symbol':'1.2-2' }}</td>
        <td class="px-4 py-2 text-center">{{ customer.lastTransactionDate | date:'dd-MMM-yyyy' }}</td>
      </tr>

      <!-- Empty State -->
      <tr *ngIf="customers.length === 0">
        <td colspan="11" class="text-center py-4 text-gray-400">No customers found.</td>
      </tr>
    </tbody>
  </table>
</div>

<!-- 📄 Pagination Controls -->
<div class="flex justify-between items-center mt-4 text-white">
  <button (click)="prevPage()" [disabled]="filter.pageNo === 1"
    class="px-3 py-1 bg-slate-800 rounded disabled:opacity-50">Previous</button>
  <span>Page {{ filter.pageNo }} </span>
  <button (click)="nextPage()"
    class="px-3 py-1 bg-slate-800 rounded disabled:opacity-50">Next</button>
</div>





<!-- Party Statement Popup -->
<!-- Party Statement Popup -->
<div 
  *ngIf="showPartyStatement" 
  class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50"
>
  <div class="bg-slate-900 rounded-2xl shadow-2xl w-full max-w-6xl p-6 relative border border-slate-700">
    
    <!-- Close Button -->
    <button 
      (click)="showPartyStatement = false" 
      class="absolute top-3 right-3 text-gray-400 hover:text-red-500 text-2xl font-bold"
    >
      ✕
    </button>
    
    <!-- Title -->
    <h2 class="text-2xl font-bold text-center mb-4 text-[#00ffee] uppercase tracking-wide">
      Party Statement
    </h2>

    <!-- Party Info -->
    <div class="flex justify-center gap-10 mb-6 text-white text-lg">
      <div>
        <span class="font-semibold text-[#00ffee]">Party Name:</span> Vikash
      </div>
      <div>
        <span class="font-semibold text-[#00ffee]">Contact No:</span> 0000000000
      </div>
    </div>

    <!-- Table -->
    <div class="overflow-x-auto overflow-y-auto bg-slate-800 rounded-lg shadow-lg max-h-[500px]">
      <table class="min-w-full text-white border-collapse">
        <thead
          class="bg-gradient-to-r from-slate-900 to-slate-800 text-[#00ffee] uppercase text-sm md:text-base tracking-wide sticky top-0 z-50"
        >
          <tr>
            <th class="px-4 py-2 border-b border-slate-700">Paid Amount</th>
            <th class="px-4 py-2 border-b border-slate-700">Balance Due</th>
            <th class="px-4 py-2 border-b border-slate-700">Total Amt</th>
            <th class="px-4 py-2 border-b border-slate-700">Payment Mode Type</th>
            <th class="px-4 py-2 border-b border-slate-700">Transaction Type</th>
            <th class="px-4 py-2 border-b border-slate-700">Sale Date</th>
            <th class="px-4 py-2 border-b border-slate-700">Total Items</th>
            <th class="px-4 py-2 border-b border-slate-700">Total Discount</th>
            <th class="px-4 py-2 border-b border-slate-700">Tax</th>
            <th class="px-4 py-2 border-b border-slate-700">Transaction Date</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-slate-700">
          <tr 
            *ngFor="let record of partyStatement" 
            class="hover:bg-slate-700 transition cursor-pointer"
          >
            <td class="px-4 py-2 text-center">{{ record.paidAmount }}</td>
            <td class="px-4 py-2 text-center">{{ record.balanceDue }}</td>
            <td class="px-4 py-2 text-center">{{ record.totalAmt }}</td>
            <td class="px-4 py-2 text-center">{{ record.paymentModeType }}</td>
            <td class="px-4 py-2 text-center">{{ record.transactionType }}</td>
            <td class="px-4 py-2 text-center">{{ record.saleDate | date:'dd-MMM-yyyy' }}</td>
            <td class="px-4 py-2 text-center">{{ record.totalItems }}</td>
            <td class="px-4 py-2 text-center">{{ record.totalDiscount }}</td>
            <td class="px-4 py-2 text-center">{{ record.tax }}</td>
            <td class="px-4 py-2 text-center">{{ record.transactionDate | date:'short' }}</td>
          </tr>

          <!-- Empty State -->
          <tr *ngIf="partyStatement.length === 0">
            <td colspan="10" class="text-center py-4 text-gray-400">No records found.</td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Footer -->
    <div class="flex justify-between items-center mt-4">
      <!-- PDF Export Button -->
      <button 
        (click)="exportToPdf()" 
        class="flex items-center gap-2 px-5 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition shadow-md"
      >
        <i class="fas fa-file-pdf"></i> Export PDF
      </button>

      <!-- Close Button -->
      <button 
        (click)="showPartyStatement = false" 
        class="px-5 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition shadow-md"
      >
        Close
      </button>
    </div>
  </div>
</div>



