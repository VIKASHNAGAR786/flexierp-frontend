<div class="min-h-screen bg-gray-900 text-white font-sans p-6">
  <h2 class="text-2xl font-semibold mb-6 text-[#00ffee] text-center drop-shadow-md">
    üóíÔ∏è My Notes
  </h2>

  <!-- Add Note Button -->
  <div class="text-center mb-6">
    <button (click)="openPopup()"
      class="py-2 px-5 rounded-lg bg-[#00ffee] text-black font-semibold hover:bg-[#00e6d5] transition shadow-md">
      ‚ûï Add New Note
    </button>
  </div>

  <!-- Notes List -->
  <div *ngIf="allnotes.length > 0; else noNotes">
    <div class="space-y-4 max-h-[500px] overflow-y-auto p-2">
      <div *ngFor="let note of allnotes"
        class="bg-slate-800/70 backdrop-blur-md p-5 rounded-2xl shadow-lg border border-slate-700 hover:border-[#00ffee]/70 hover:shadow-[#00ffee]/20 transition-all duration-300 relative">

        <!-- Header: Title + Actions -->
        <div class="flex items-start justify-between mb-3">
          <div>
            <h3 class="text-xl font-semibold text-[#00ffee] leading-tight mb-1">
              {{ note.title }}
            </h3>
            <p class="text-sm text-gray-400">
              Author: <span class="text-gray-300">{{ note.authorId }}</span>
            </p>
          </div>

          <!-- Compact Action Buttons -->
          <div class="flex items-center space-x-2">
            <button appTooltip="View Note" [tooltipPosition]="'bottom'" [tooltipFixed]="false"
              (click)="viewNote(note.id)"
              class="p-2 rounded-lg bg-slate-700/60 hover:bg-slate-700 transition text-blue-400">
              <i class="bi bi-eye text-base"></i>
            </button>

            <button appTooltip="Edit Note" [tooltipPosition]="'bottom'" [tooltipFixed]="false" (click)="editNote(note.id)"
              class="p-2 rounded-lg bg-slate-700/60 hover:bg-slate-700 transition text-green-400">
              <i class="bi bi-pencil-square text-base"></i>
            </button>

            <button appTooltip="Pin Note" [tooltipPosition]="'bottom'" [tooltipFixed]="false" (click)="pinNote(note)"
              class="p-2 rounded-lg bg-slate-700/60 hover:bg-slate-700 transition text-yellow-400">
              <i class="bi bi-pin-angle text-base"></i>
            </button>

            <button appTooltip="Delete Note" [tooltipPosition]="'bottom'" [tooltipFixed]="false"
              (click)="deleteNote(note.id)"
              class="p-2 rounded-lg bg-slate-700/60 hover:bg-slate-700 transition text-red-400">
              <i class="bi bi-trash3 text-base"></i>
            </button>
          </div>
        </div>

        <!-- Note Content -->
        <div class="text-gray-200 leading-relaxed prose prose-invert max-w-none" [innerHTML]="note.content"></div>

        <!-- Footer: Date -->
        <div class="text-xs text-gray-400 italic mt-4 border-t border-slate-700 pt-2 flex justify-end">
          {{ note.createdAt | date:'medium' }}
        </div>
      </div>
    </div>
  </div>

  <!-- No Notes Template -->
  <ng-template #noNotes>
    <p class="text-gray-400 text-center mt-6">No notes available. Start by adding one!</p>
  </ng-template>

  <!-- No Notes Template -->
  <ng-template #noNotes>
    <p class="text-gray-400 text-center mt-6">No notes available. Start by adding one!</p>
  </ng-template>



  <!-- No Notes Template -->
  <ng-template #noNotes>
    <p class="text-center text-gray-400">No notes yet. Click ‚ÄúAdd New Note‚Äù to start.</p>
  </ng-template>

  <!-- Add Note Popup --------------------------------------------------------->
  <div *ngIf="showPopup" class="fixed inset-0 bg-black/70 flex justify-center items-center z-50">
    <div class="bg-slate-900 p-8 rounded-2xl shadow-2xl w-full max-w-3xl relative border border-slate-700">

      <!-- Close Button -->
      <button (click)="closePopup()"
        class="absolute top-4 right-5 text-gray-400 hover:text-[#00ffee] text-2xl font-bold transition">
        ‚úñ
      </button>

      <h2 class="text-2xl font-semibold mb-6 text-[#00ffee] text-center drop-shadow-md">üìù Create a New Note</h2>

      <div class="space-y-6">
        <!-- Title -->
        <div>
          <label class="block text-sm font-medium text-gray-300 mb-1">Note Title *</label>
          <input type="text" [(ngModel)]="noteTitle" placeholder="Enter your note title..."
            class="w-full p-3 rounded-lg bg-slate-800/70 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-[#00ffee] shadow-inner placeholder-gray-400" />
        </div>

        <!-- Rich Text Editor -->
        <div>
          <label class="block text-sm font-medium text-gray-300 mb-2">Note Content *</label>

          <!-- Toolbar -->
          <div
            class="flex flex-wrap items-center justify-center gap-3 mb-3 bg-slate-800/70 p-3 rounded-lg border border-slate-700 shadow-inner">
            <button type="button" (click)="formatText('bold')" title="Bold"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg font-bold">B</button>
            <button type="button" (click)="formatText('italic')" title="Italic"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded italic text-lg">I</button>
            <button type="button" (click)="formatText('underline')" title="Underline"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded underline text-lg">U</button>
            <button type="button" (click)="formatText('strikeThrough')" title="Strikethrough"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg line-through">S</button>

            <div class="w-px h-5 bg-slate-600"></div>

            <button type="button" (click)="formatText('insertUnorderedList')" title="Bullet List"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg">‚Ä¢ List</button>
            <button type="button" (click)="formatText('insertOrderedList')" title="Numbered List"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg">1. List</button>

            <div class="w-px h-5 bg-slate-600"></div>

            <button type="button" (click)="formatText('justifyLeft')" title="Align Left"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg">‚á§</button>
            <button type="button" (click)="formatText('justifyCenter')" title="Align Center"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg">‚ò∞</button>
            <button type="button" (click)="formatText('justifyRight')" title="Align Right"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg">‚á•</button>

            <div class="w-px h-5 bg-slate-600"></div>

            <button type="button" (click)="formatText('undo')" title="Undo"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg">‚Ü∂</button>
            <button type="button" (click)="formatText('redo')" title="Redo"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg">‚Ü∑</button>
          </div>

          <div #editor id="noteEditor" contenteditable="true" dir="ltr" spellcheck="true" (input)="onNoteInput($event)"
            class="w-full min-h-[250px] p-4 rounded-lg bg-slate-800/50 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-[#00ffee] shadow-inner overflow-y-auto text-left">
          </div>

        </div>

        <!-- Flags -->
        <div class="flex items-center justify-center space-x-8 mt-4">
          <label class="flex items-center space-x-2 text-sm text-gray-300">
            <input type="checkbox" [(ngModel)]="notePinned"
              class="h-5 w-5 text-[#00ffee] bg-slate-800/50 border-slate-600 rounded focus:ring-[#00ffee] focus:ring-2" />
            <span>Pinned</span>
          </label>
          <label class="flex items-center space-x-2 text-sm text-gray-300">
            <input type="checkbox" [(ngModel)]="noteArchived"
              class="h-5 w-5 text-[#00ffee] bg-slate-800/50 border-slate-600 rounded focus:ring-[#00ffee] focus:ring-2" />
            <span>Archived</span>
          </label>
        </div>

        <!-- Add Note Button -->
        <button (click)="addNote()"
          class="w-full py-3 px-4 rounded-lg font-semibold bg-[#00ffee] text-black hover:bg-[#00e6d5] transition-all shadow-md text-lg">
          üíæ Save Note
        </button>
      </div>
    </div>
  </div>


  <!-- View Note Details Popup -->
  <div *ngIf="showNoteDetailPopup" class="fixed inset-0 bg-black/70 flex justify-center items-center z-50">
    <div
      class="bg-slate-800 p-8 rounded-2xl shadow-2xl w-[90%] max-w-3xl relative border border-[#00ffee] overflow-y-auto max-h-[85vh] text-white">
      <!-- Close Button -->
      <button (click)="closeNoteDetailPopup()"
        class="absolute top-4 right-4 text-gray-300 hover:text-[#00ffee] text-2xl font-bold">
        ‚úñ
      </button>

      <!-- Header -->
      <h2 class="text-2xl font-semibold mb-6 text-[#00ffee] text-center tracking-wide">
        üìù Note Details
      </h2>

      <!-- Note Details -->
      <div *ngIf="selectedNote; else loadingNote" class="space-y-5">
        <div class="p-4 bg-slate-700/50 rounded-lg shadow-inner border border-slate-600">
          <h3 class="text-2xl font-semibold text-[#00ffee] mb-3">
            Title : {{ selectedNote.title || 'Untitled Note' }}
          </h3>

          <div class="text-base text-gray-100 leading-relaxed mb-4 whitespace-pre-wrap"
            [innerHTML]="selectedNote.content || 'No content available'"></div>

          <div class="text-sm text-gray-300 border-t border-slate-600 pt-3 space-y-1">
            <p><span class="font-medium text-[#00ffee]">Author:</span> {{ selectedNote.authorname || 'N/A' }}</p>
            <p><span class="font-medium text-[#00ffee]">Created:</span> {{ selectedNote.createdat | date:'medium' }}</p>
          </div>
        </div>
      </div>

      <!-- Loading Template -->
      <ng-template #loadingNote>
        <div class="text-center text-gray-300 text-lg mt-6">
          Loading note details...
        </div>
      </ng-template>
    </div>
  </div>

  <div *ngIf="openEditPopup" class="fixed inset-0 bg-black/70 flex justify-center items-center z-50">
    <div class="bg-slate-900 p-8 rounded-2xl shadow-2xl w-full max-w-3xl relative border border-slate-700">

      <!-- Close Button -->
      <button (click)="closeEditPopup()"
        class="absolute top-4 right-5 text-gray-400 hover:text-[#00ffee] text-2xl font-bold transition">
        ‚úñ
      </button>

      <h2 class="text-2xl font-semibold mb-6 text-[#00ffee] text-center drop-shadow-md">üìù Create a New Note</h2>

      <div class="space-y-6">
        <!-- Title -->
        <div>
          <label class="block text-sm font-medium text-gray-300 mb-1">Note Title *</label>
          <input type="text" [(ngModel)]="noteTitle" placeholder="Enter your note title..."
            class="w-full p-3 rounded-lg bg-slate-800/70 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-[#00ffee] shadow-inner placeholder-gray-400" />
        </div>

        <!-- Rich Text Editor -->
        <div>
          <label class="block text-sm font-medium text-gray-300 mb-2">Note Content *</label>

          <!-- Toolbar -->
          <div
            class="flex flex-wrap items-center justify-center gap-3 mb-3 bg-slate-800/70 p-3 rounded-lg border border-slate-700 shadow-inner">
            <button type="button" (click)="formatText('bold')" title="Bold"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg font-bold">B</button>
            <button type="button" (click)="formatText('italic')" title="Italic"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded italic text-lg">I</button>
            <button type="button" (click)="formatText('underline')" title="Underline"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded underline text-lg">U</button>
            <button type="button" (click)="formatText('strikeThrough')" title="Strikethrough"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg line-through">S</button>

            <div class="w-px h-5 bg-slate-600"></div>

            <button type="button" (click)="formatText('insertUnorderedList')" title="Bullet List"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg">‚Ä¢ List</button>
            <button type="button" (click)="formatText('insertOrderedList')" title="Numbered List"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg">1. List</button>

            <div class="w-px h-5 bg-slate-600"></div>

            <button type="button" (click)="formatText('justifyLeft')" title="Align Left"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg">‚á§</button>
            <button type="button" (click)="formatText('justifyCenter')" title="Align Center"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg">‚ò∞</button>
            <button type="button" (click)="formatText('justifyRight')" title="Align Right"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg">‚á•</button>

            <div class="w-px h-5 bg-slate-600"></div>

            <button type="button" (click)="formatText('undo')" title="Undo"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg">‚Ü∂</button>
            <button type="button" (click)="formatText('redo')" title="Redo"
              class="px-2 py-1 text-[#00ffee] hover:bg-[#00ffee]/10 rounded text-lg">‚Ü∑</button>
          </div>

          <div #editor id="noteEditor" contenteditable="true" dir="ltr" spellcheck="true" (input)="onEditNoteInput($event)"
            class="w-full min-h-[250px] p-4 rounded-lg bg-slate-800/50 text-white border border-slate-600 focus:outline-none focus:ring-2 focus:ring-[#00ffee] shadow-inner overflow-y-auto text-left">
          </div>

        </div>

        <!-- Flags -->
        <div class="flex items-center justify-center space-x-8 mt-4">
          <label class="flex items-center space-x-2 text-sm text-gray-300">
            <input type="checkbox" [(ngModel)]="notePinned"
              class="h-5 w-5 text-[#00ffee] bg-slate-800/50 border-slate-600 rounded focus:ring-[#00ffee] focus:ring-2" />
            <span>Pinned</span>
          </label>
          <label class="flex items-center space-x-2 text-sm text-gray-300">
            <input type="checkbox" [(ngModel)]="noteArchived"
              class="h-5 w-5 text-[#00ffee] bg-slate-800/50 border-slate-600 rounded focus:ring-[#00ffee] focus:ring-2" />
            <span>Archived</span>
          </label>
        </div>

        <!-- Add Note Button -->
        <button (click)="EditaddNote()"
          class="w-full py-3 px-4 rounded-lg font-semibold bg-[#00ffee] text-black hover:bg-[#00e6d5] transition-all shadow-md text-lg">
          üíæ Save Note
        </button>
      </div>
    </div>
  </div>


  <!-- Inline confirmation popup -->
<!-- Overlay -->
<div *ngIf="deleteNoteId !== 0" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
  <!-- Modal -->
  <div class="bg-slate-800 text-white p-6 rounded-lg shadow-lg w-[300px]">
    <h3 class="text-lg font-semibold mb-3">Confirm Delete</h3>
    <p class="mb-4">Are you sure you want to delete this note?</p>
    <div class="flex justify-end gap-3">
      <button (click)="confirmDelete(true)" class="px-4 py-2 bg-red-500 hover:bg-red-600 rounded">Yes, Delete</button>
      <button (click)="confirmDelete(false)" class="px-4 py-2 bg-gray-500 hover:bg-gray-600 rounded">Cancel</button>
    </div>
  </div>
</div>


</div>