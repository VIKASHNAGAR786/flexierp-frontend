<div *ngIf="showProductList" class="fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm">

  <!-- Modal Container (smaller size) -->
  <div class="bg-slate-900 w-10/12 md:w-3/4 lg:w-2/3 xl:w-1/2 
              rounded-xl shadow-2xl p-6 overflow-hidden flex flex-col max-h-[80vh]">

    <!-- Header + Close Button -->
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-xl md:text-2xl font-extrabold text-[#00ffee] uppercase drop-shadow-md">
        Product List
      </h2>
      <button (click)="onClose()" 
              class="text-slate-900 bg-[#00ffee] px-3 py-1 rounded hover:bg-[#00ccbb] transition">
        Close
      </button>
    </div>

    <!-- ðŸ” Search + Filters -->
    <div class="flex flex-wrap justify-between items-center gap-2 mb-4">
      <input type="text" [(ngModel)]="filter.searchTerm" (ngModelChange)="getProductData()" 
             placeholder="Search products..."
             class="px-3 py-2 rounded-lg bg-slate-800 text-white border border-slate-600 
                    focus:outline-none focus:ring-2 focus:ring-[#00ffee] w-full md:w-1/3" />

      <div class="flex gap-2">
        <input type="date" [(ngModel)]="filter.startDate" (ngModelChange)="getProductData()"
               class="px-3 py-2 rounded bg-slate-800 text-white border border-slate-600" />
        <input type="date" [(ngModel)]="filter.endDate" (ngModelChange)="getProductData()"
               class="px-3 py-2 rounded bg-slate-800 text-white border border-slate-600" />
      </div>

      <select [(ngModel)]="filter.pageSize" (change)="getProductData()"
              class="px-3 py-2 rounded bg-slate-800 text-white border border-slate-600">
        <option *ngFor="let size of pageSizes" [value]="size">{{ size }} per page</option>
      </select>
    </div>

    <!-- Product Table -->
    <div class="overflow-x-auto overflow-y-auto rounded-lg shadow-lg relative flex-1 max-h-[50vh]">
      <table class="min-w-full text-white border-collapse text-sm">
        <thead class="bg-gradient-to-r from-slate-900 to-slate-800 text-[#00ffee] uppercase text-xs md:text-sm tracking-wide sticky top-0 z-50">
          <tr>
            <th class="px-3 py-2 border-b border-slate-700">Sr.No</th>
            <th class="px-3 py-2 border-b border-slate-700">Barcode</th>
            <th class="px-3 py-2 border-b border-slate-700">Name</th>
            <th class="px-3 py-2 border-b border-slate-700">Category</th>
            <th class="px-3 py-2 border-b border-slate-700">Packed Date</th>
            <th class="px-3 py-2 border-b border-slate-700">Weight</th>
            <th class="px-3 py-2 border-b border-slate-700">Perishable</th>
            <th class="px-3 py-2 border-b border-slate-700">Created By</th>
            <th class="px-3 py-2 border-b border-slate-700">Purchase Price</th>
            <th class="px-3 py-2 border-b border-slate-700">Selling Price</th>
            <th class="px-3 py-2 border-b border-slate-700">Tax Rate</th>
            <th class="px-3 py-2 border-b border-slate-700">Discount</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-slate-700">
          <tr *ngFor="let product of products; let i = index"
              class="hover:bg-slate-700 transition cursor-pointer"
              (click)="onRowClick(product)">
            <td class="px-3 py-2 text-center">{{ (filter.pageNo - 1) * filter.pageSize + i + 1 }}</td>
            <td class="px-3 py-2">{{ product.barCode }}</td>
            <td class="px-3 py-2">{{ product.productName }}</td>
            <td class="px-3 py-2">{{ product.categoryName }}</td>
            <td class="px-3 py-2 text-center">{{ product.packedDate | date:'yyyy-MM-dd' }}</td>
            <td class="px-3 py-2 text-center">{{ product.packedWeight }}</td>
            <td class="px-3 py-2 text-center">{{ product.isPerishable ? 'Yes' : 'No' }}</td>
            <td class="px-3 py-2">{{ product.fullName }}</td>
            <td class="px-3 py-2 text-center">{{ product.purchasePrice | currency:'INR':'symbol':'1.2-2' }}</td>
            <td class="px-3 py-2 text-center">{{ product.sellingPrice | currency:'INR':'symbol':'1.2-2' }}</td>
            <td class="px-3 py-2 text-center">{{ product.taxRate }}%</td>
            <td class="px-3 py-2 text-center">{{ product.discount }}%</td>
          </tr>
          <tr *ngIf="products.length === 0">
            <td colspan="16" class="text-center py-4 text-gray-400">
              No products available.
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Actions -->
    <div class="flex justify-between items-center mt-4 flex-wrap gap-2">
      <button (click)="generateBarcodePDF()" [disabled]="selectedBarcodes.length === 0" 
              class="px-4 py-2 rounded text-black bg-[#00ffee] hover:bg-[#00ddcc] disabled:bg-gray-400 disabled:cursor-not-allowed">
        Generate Bar Code PDF
      </button>

      <!-- Pagination -->
      <div class="flex items-center gap-2 text-white text-sm">
        <button (click)="prevPage()" [disabled]="filter.pageNo === 1"
                class="px-2 py-1 bg-slate-800 rounded disabled:opacity-50">Previous</button>
        <span>Page {{ filter.pageNo }} of {{ totalPages }}</span>
        <button (click)="nextPage()" [disabled]="filter.pageNo === totalPages"
                class="px-2 py-1 bg-slate-800 rounded disabled:opacity-50">Next</button>
      </div>
    </div>

  </div>
</div>
