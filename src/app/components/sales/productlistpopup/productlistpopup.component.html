<div *ngIf="showProductList"
     class="fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm"
     style="background: var(--modal-overlay);">

  <!-- Modal Container -->
  <div class="w-10/12 md:w-3/4 lg:w-2/3 xl:w-1/2 rounded-xl shadow-2xl p-6 flex flex-col max-h-[80vh]"
       style="background: var(--card-bg); color: var(--text); border: 1px solid var(--card-border);">

    <!-- Header -->
    <div class="flex justify-between items-center mb-4">
      <h2 class="text-xl md:text-2xl font-extrabold uppercase drop-shadow-md"
          style="color: var(--heading);">
        Product List
      </h2>

      <button (click)="onClose()"
              class="px-3 py-1 rounded transition"
              style="background: var(--accent-1); color: var(--accent-1-text);">
        Close
      </button>
    </div>

    <!-- Filters -->
    <div class="flex flex-wrap justify-between items-center gap-2 mb-4">

      <!-- Search -->
      <input type="text"
             [(ngModel)]="filter.searchTerm"
             (ngModelChange)="getProductData()"
             placeholder="Search products..."
             class="px-3 py-2 rounded-lg w-full md:w-1/3 outline-none"
             style="background: var(--input-bg); border: 1px solid var(--input-border); color: var(--input-text);" />

      <!-- Dates -->
      <div class="flex gap-2">
        <input type="date"
               [(ngModel)]="filter.startDate"
               (ngModelChange)="getProductData()"
               class="px-3 py-2 rounded outline-none"
               style="background: var(--input-bg); border: 1px solid var(--input-border); color: var(--input-text);" />

        <input type="date"
               [(ngModel)]="filter.endDate"
               (ngModelChange)="getProductData()"
               class="px-3 py-2 rounded outline-none"
               style="background: var(--input-bg); border: 1px solid var(--input-border); color: var(--input-text);" />
      </div>

      <!-- Page Size -->
      <select [(ngModel)]="filter.pageSize"
              (change)="getProductData()"
              class="px-3 py-2 rounded outline-none"
              style="background: var(--input-bg); border: 1px solid var(--input-border); color: var(--input-text);">
        <option *ngFor="let size of pageSizes" [value]="size">{{ size }} per page</option>
      </select>

    </div>

    <!-- Table -->
    <div class="overflow-x-auto overflow-y-auto rounded-lg shadow-lg flex-1 max-h-[50vh]"
         style="border: 1px solid var(--table-border);">

      <table class="min-w-full border-collapse text-sm"
             style="color: var(--text);">

        <thead class="sticky top-0 z-50 uppercase text-xs md:text-sm tracking-wide"
               style="background: var(--table-header-bg); color: var(--table-header-text);">
          <tr>
            <th class="px-3 py-2" style="border-bottom: 1px solid var(--table-border);">Sr.No</th>
            <th class="px-3 py-2" style="border-bottom: 1px solid var(--table-border);">Barcode</th>
            <th class="px-3 py-2" style="border-bottom: 1px solid var(--table-border);">Name</th>
            <th class="px-3 py-2" style="border-bottom: 1px solid var(--table-border);">Category</th>
            <th class="px-3 py-2" style="border-bottom: 1px solid var(--table-border);">Packed Date</th>
            <th class="px-3 py-2" style="border-bottom: 1px solid var(--table-border);">Weight</th>
            <th class="px-3 py-2" style="border-bottom: 1px solid var(--table-border);">Perishable</th>
            <th class="px-3 py-2" style="border-bottom: 1px solid var(--table-border);">Created By</th>
            <th class="px-3 py-2" style="border-bottom: 1px solid var(--table-border);">Purchase Price</th>
            <th class="px-3 py-2" style="border-bottom: 1px solid var(--table-border);">Selling Price</th>
            <th class="px-3 py-2" style="border-bottom: 1px solid var(--table-border);">Tax Rate</th>
            <th class="px-3 py-2" style="border-bottom: 1px solid var(--table-border);">Discount</th>
          </tr>
        </thead>

        <tbody>

          <tr *ngFor="let product of products; let i = index"
              class="cursor-pointer transition"
              (click)="onRowClick(product)"
              onmouseover="this.style.background='var(--table-row-hover)'"
              onmouseout="this.style.background='transparent'"
              style="border-bottom: 1px solid var(--table-border);">
            <td class="px-3 py-2 text-center">{{ (filter.pageNo - 1) * filter.pageSize + i + 1 }}</td>
            <td class="px-3 py-2">{{ product.barCode }}</td>
            <td class="px-3 py-2">{{ product.productName }}</td>
            <td class="px-3 py-2">{{ product.categoryName }}</td>
            <td class="px-3 py-2 text-center">{{ product.packedDate | date:'yyyy-MM-dd' }}</td>
            <td class="px-3 py-2 text-center">{{ product.packedWeight }}</td>
            <td class="px-3 py-2 text-center">{{ product.isPerishable ? 'Yes' : 'No' }}</td>
            <td class="px-3 py-2">{{ product.fullName }}</td>
            <td class="px-3 py-2 text-center">{{ product.purchasePrice | currency:'INR':'symbol':'1.2-2' }}</td>
            <td class="px-3 py-2 text-center">{{ product.sellingPrice | currency:'INR':'symbol':'1.2-2' }}</td>
            <td class="px-3 py-2 text-center">{{ product.taxRate }}%</td>
            <td class="px-3 py-2 text-center">{{ product.discount }}%</td>
          </tr>

          <tr *ngIf="products.length === 0">
            <td colspan="16" class="text-center py-4"
                style="color: var(--text-muted);">
              No products available.
            </td>
          </tr>

        </tbody>

      </table>

    </div>

    <!-- Actions -->
    <div class="flex justify-between items-center mt-4 flex-wrap gap-2">

      <!-- <button (click)="generateBarcodePDF()"
              [disabled]="selectedBarcodes.length === 0"
              class="px-4 py-2 rounded disabled:cursor-not-allowed transition"
              style="
                background: var(--accent-1);
                color: var(--accent-1-text);
                opacity: 1;
              "
              [ngStyle]="selectedBarcodes.length === 0 ? { 'opacity': 0.4 } : {}">
        Generate Bar Code PDF
      </button> -->

      <!-- Pagination -->
      <div class="flex items-center gap-2 text-sm" style="color: var(--text);">

        <button (click)="prevPage()"
                [disabled]="filter.pageNo === 1"
                class="px-2 py-1 rounded disabled:opacity-50"
                style="background: var(--button-bg); color: var(--button-text); border: 1px solid var(--button-border);">
          Previous
        </button>

        <span>Page {{ filter.pageNo }} of {{ totalPages }}</span>

        <button (click)="nextPage()"
                [disabled]="filter.pageNo === totalPages"
                class="px-2 py-1 rounded disabled:opacity-50"
                style="background: var(--button-bg); color: var(--button-text); border: 1px solid var(--button-border);">
          Next
        </button>

      </div>

    </div>

  </div>
</div>
